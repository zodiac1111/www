<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- Copyright (c) Echon., 2006. All Rights Reserved. 网口监视参数页面-->
<html>
	<head>
		<title>网络参数设置</title>
		<meta http-equiv="Pragma" content="no-cache" charset=utf-8>
		<link rel="stylesheet" href="/style/normal_ws.css" type="text/css" />
		<link rel="stylesheet" href="/style/sys.css" type="text/css" />
		<link rel="stylesheet" href="/style/table.css" type="text/css" />
		<link href="/style/menuExpandable3.css" rel="stylesheet" type="text/css" />
		<script src="/style/wwyfunc.js"  type='text/javascript'></script>
		<!-- jquery -开始-->
		<link rel="stylesheet" media="all" type="text/css" href="/style/jquery-ui.css" />
		<link rel="stylesheet" media="all" type="text/css" href="/style/jquery-ui-timepicker-addon.css" />
		<script type="text/javascript" src="/style/jquery-1.8.3.min.js"></script>
		<script type="text/javascript" src="/style/jquery-ui.min.js"></script>
		<script type="text/javascript" src="/style/jquery-ui.min-zh-CN.js"></script>
		<!-- jquery的 -结束 -->
		<script type="text/javascript">
			$(document).ready(function() {
				/* 按钮 */
				$(function() {
					$(".btn_update").button({
						icons : {
							primary : "ui-icon-refresh"
						}
					});
				});
				$("#icon_init").hide();
				$("#icon_ok").hide();
				// post提交
				/* 定义按钮 post函数 */
				$("#btnUpdate").click(function() {
					var errobj = document.getElementById("errobj");
					if (errobj != null) {
						alert("非法参数");
						return;
					}
					$("#icon_init").show();
					//$("#tbody_dat").html("<tr><td colspan=\"6\" ></td></tr>");
					//$("#tbody_dat tr td").addClass('load_bgpic_hight');
					$.post('/goform/netpara', $("#netpara").serialize(), function(result) {
						//$("#tbody_dat tr td").removeClass('load_bgpic_hight');
						//$("#tbody_dat").html(result);
						$("#icon_init").hide();
						$("#icon_ok").show();
						$("#icon_ok").hide("fade", 1000);
						//alert("OK");
					});
				});
				/* 隐藏的按钮用于初始化,应为post的form只能使用按钮触发 */
				$("#init").click(function() {
					$("#icon_init").show();
					$.post('/goform/netpara', "init=1", function(result) {
						//alert(result);
						//$("#tbody_dat").html(result); //待删除,无用的代码,之前使用html传输数据
						//使用json传递数据 从数据中分解出对象数组.
						var aNetParas = JSON.parse(result);
						$("#tbody_dat").html("");
						for (var i in aNetParas.item) {
							var str = "<tr>";
							//
							str += "<td><input name=net_no type=text readonly size=1 value=" + aNetParas.item[i].no + "></td>";
							str += "<td><select name=eth >";
							for (var j = 0; j < aNetParas.eth_num; j++) {
								str += "<option value=" + j;
								if (j == aNetParas.item[i].eth)
									str += " selected";
								str += ">ETH";
								str += j + 1;
								str += "</option>"
							}
							str += "</select></td>"
							str += "<td><input name=ip type=text size=15 maxlength=15 onchange=\"isIPv4(event);\" value=\"" + aNetParas.item[i].ip + "\"></td>";
							str += "<td><input name=mask type=text size=15 maxlength=15 onchange=\"isIPv4(event);\" value=\"" + aNetParas.item[i].mask + "\"></td>";
							str += "<td><input name=gateway type=text size=15 maxlength=15 onchange=\"isIPv4(event);\" value=\"" + aNetParas.item[i].gateway + "\"></td>";
							str += "</tr>"
							$("#tbody_dat").append(str);
						}//end for 一行
						$("#icon_init").hide("fade", 2000);
						//alert("debug: Ajax ok");
					});
				});
				/* 页面载入,读取一次(点击) */
				$("#init").click();
			});
		</script>
	</head>
	<body>
		<h1 align="center"><img src="/graphics/logo42.png" height="45"></h1>
		<form id="netpara"  name="netpara">
			<table class="sioplanTable" border="1">
				<thead>
					<tr>
						<th>网口号</th>
						<th>使用网口</th>
						<th>IP地址</th>
						<th>子网掩码</th>
						<th>网关</th>
					</tr>
				</thead>
				<tbody id="tbody_dat"><tr><td>载入数据...</td></tr></tbody>
			</table>
		</form>
		<p ALIGN="center">
			<!-- 提交操作类型 更新,还是其他 -->
			<input class="hideinp" type="text" name="OpType" value="" id="optype">
			<button id="init" class="hideinp">读取</button><!-- 隐藏，仅载入时读取一次　-->
			<button id="btnUpdate" class="btn_update">更新</button>
			<input type="text" id="icon_init" class="wait_icon_24x24_load" />
			<input type="text" id="icon_ok" class="wait_icon_24x24 ok_24x24" />
		</p>

	</body>
</html>
